#ifndef PLATON_MPCC_CPP
#define PLATON_MPCC_CPP

#include <platon/platon.hpp>
#include <stdio.h>
#include <stdlib.h>
#include <string>

namespace mpc {

#define COMMON_SPLIT_CHAR "&"
#define OWNER "__OWNER__"

#define PREFIX "__MPC__"
#define PREFIX_BONUS_RULE "__BONUS_RULE__"

#define KEY_IR "__IR__"
#define KEY_PARTIES PREFIX "__PARTIES__"
#define KEY_URLS PREFIX "__URLS__"
#define KEY_INVITORS PREFIX "__INVITOR__"
#define KEY_TASK_INFO PREFIX "__TASK__"
#define KEY_METHOD_PRICE PREFIX "__METHOD_PRICE__"

/// IR data -> IR_VALUE_TEMPLATE
#define IR_VALUE "4243c0de3514000005000000620c30244959bea6eed37e2d4401320500000000210c0000e20d00000b02210002000000130000000781239141c80449061032399201840c250508191e048b62801c450242920b42e41032143808184b0a32728848901420434688a50019324204490e909123c4504151818ce183e58a0439460651180000610200001bd426f8ffffffff0170803200c280188777900779288771a00776c88736908777a80777208772208736208774b08774208772688379880779a0873630077868837608077a4007c01cc2811de6a11c00821cd2611ec2411cd8a11cda801ec2211dd8a10dc6211cd8811de60130877060877928078060877298877968037890877218877498877268037380877608077200cc211cd8611eca0120dce11ddac01ce4211cdaa11cda001ede211ddc811eca411edaa01cd8211dda01a00779a88772000677788736300779088776288736808777480777a0877290873628077648877668037778077768037628877030078070877768837470077398873630077868837608077a4007c01cc2811de6a11c00c21ddea10dd4a11eda011eda801ec2411cd8a11ce60130877060877928078070877768037708077798873630077868837608077a4007c01cc2811de6a11c00c21ddea10de6211dcec11dca811cda401fca411ede611edac01ce0a10dda211ce8011d0073080776988772000877788736a0077908077880877470877368837608077a4007c01cc2811de6a11c00621ee8211cc6611dda001ee4e11de8a11cc6811ede411eda401ceac11ccca11ce4a10de6211df4a11c003c00087a080779388772a08736180778a807001ff0c00edac00ee80020e8211ce4e11cca811edac01cca211ce8a11ee4a11ce601580373c0877990073658837668077c60833598877928073658837998877290033658037cc0833b00887a70877908077328873630077868837608077a4007c01cc2811de6a11c00a21ee6a11cda601edec11ce8a10dcc811dde211ce80130877060877928076083cb08ffffffff3f10e3f00ef2200fe5300ef4c00ef9d006f2f00ef5e00ee4500ee4d006e4900ef6900ee4500e6d300ff1200ff4d006e6000f6dd00ee1400fe800984338b0c33c94034090433acc433888033b94431bd04338a4033bb4c13884033bb0c33c00e6100eec300fe50010ec500ef3300f6d000ff2500ee3900ef3500e6d600ef0d00ee1400e803984033bcc433900843bbc431b98833c84433b94431bc0c33ba4833bd04339c8431b94033ba4433b00f4200ff5500ec0e00eefd006e6200fe1d00ee5d006f0f00ee9e00ef4500ef2d006e5c00ee9d00e6de00eefe00e6dc00ee5100ee60010eef00e6d900eee600ef3d006e6000f6dd00ee1400fe800984338b0c33c940340b8c33bb4813b84833bcc431b98033cb4413b84033da003600ee1c00ef3500e00e10eefd006f3900ee7e00ee5400e6da00fe5200fef300f6d600ef0d006ed100ef4800e803984033bcc433900843bbc431bd0833c84033cc0433ab8c339b4413b84033da003600ee1c00ef3500e00310ff4100ee3b00e6d000ff2f00ef4500ee3400fef200f6d200ef5600ee6500ef2d006f3900efa500e001e00043d84833c9c4339d0431b8c033cd403800f7860076d6007740010f4100ef2700ee5400f6d600ee5100ef4500ff2500ef300ac8139e0c33cc8031bac413bb4033eb0c11accc33c94031bacc13ccc4339c8011bac013ee0c11d00443db8c33c84833994431b98033cb4413b84033da003600ee1c00ef3500e00510ff3500e6d300fef600ef4d006e6c00eef100ef400984338b0c33c9403b0a11884200d880d6c43fcffffffff0038800494011006c438bc833cc843398c033db0433eb4813cbc433db80339940339b40139a4833da4033994431bcc433cc8033db48139c0431bb44338d0033a00e6100eec300fe50010e4900ef3100ee2c00ee5d006f4100ee9c00e6d300ee1c00eec300f803984033bcc433900043b94c33ccc431bc0833c94c338a4c33c94431b98033cb443389003600ee1c00ef3500e00e10eefd006e6200fe1d00ee5d006f0f00ee9e00ef4500ef2d006e5c00ee9d00e003dc8433d940330b8c33bb48139c84338b44339b4013cbc433ab8033d94833cb44139b0433ab4431bb8c33bb8431bb0433984833900843bbc431ba4833b98c33cb48139c0431bb44338d0033a00e6100eec300fe50010eef00e6da00ef5d00ef0d006f4100ee2c00ee5300f803984033bcc433900843bbc431bb84338b8c33cb48139c0431bb44338d0033a00e6100eec300fe50010eef00e6d300fe9700eee500ee4d006fa500ef2f00ef3d006e6000f6dd00ee1400fe800984338b0c33c940340b8c33bb4013dc84338c0033ca4833b9c431bb44338d0033a00e6100eec300fe50010f3400fe1300eebd006f0200fef400fe5300ef4f00ef2d006e2500fe6600ee5200f6d300fe9a00fe500e00140d04338c8c33994033db4c138c0433d00f8800776d00676400700410fe1200fe7500ef4d006e6500ee1400ff5200fe5300fc01a98033ecc833cb0c11ab4433be0031bacc13ccc4339b0c11accc33c94831cb0c11ae0031edc0140d4833bcc4338984339b48139c0431bb44338d0033a00e6100eec300fe50010f5300fe5d006f3f00ee6400f6d600eecf00ee1400f803984033bcc4339001b60a6f8ffffffff0190887178077990877218077a60877c68037978877a70077228077268037248077b48077228873698877890077a680373808736688770a0077400cc211cd8611eca0120c8211de6211cc4811dcaa10de8211cd2811dda601cc2811dd8611e00730807769887720008762887799887368007792887714887792887363007786887702007c01cc2811de6a11c00c21ddea10dcc411ec2a11dcaa10de0e11dd2c11de8a11ce4a10dca811dd2a11d007a90877a28076070877768037390877068877268037878877470077a280779688372608774688736708777708736608772080773000877788736480777308779680373808736688770a0077400cc211cd8611eca0120dce11ddac01dc2c11de6a10dcc011edaa01dc2811ed001308770608779280780708777688379488773708772208736d0877290877798873630077868837608077a4007c01cc2811de6a11c00c21ddea10de8411ec2011ee0211ddce11cdaa01dc2811ed00130877060877928078098077a08877158873680077978077a288771a0877790873610877a30077328077968837948077d2807000f00821ec2411ecea11ce8a10dc6011eea01c0073cb08336b0033a00087a080779388772a0873630877208077aa8077928877900d6c01cf0611ee4810dd6a01dda011fd8600de6611eca810dd6601ee6a11ce4800dd6001ff0e00e00a21edc611ec2c11ccaa10dcc011edaa01dc2811ed001308770608779280780a8877928873698877730077a68037360877708077a00cc211cd8611eca01d8401801d06d288e21480368438100411a401b8a2408d200d95028429006c80663f9ffffffff01680340da603001b00074b0c168046001aa0d84f3ffffffff032001491800000f00000013826042204c10846142404c088a0983601c13040199300489324108920902a14c1816a699100c13026782601c13026482902813826442a00000000089200000700000003222c809206485049323a484049323e384a19014124c8e8c0b84e44c108cc31c01921c000a240380060903a0427a00e89002004acc11804119168b05316ab0200701aab080506404608e00148611046a26671cd8211ce6611edca01cda011ef4400f44211de8010515b2cc248d033b84c33ccc831b94433bc0831ee8412ab8033d94c33994833c206171210c2d0a31c96816b429c224439d1250e85388492693a1501932990c8d66e2e6811ee4a11ec6811edc601ee8811cf4400fc6011de4e11ddce11df4400fc8a11ee4211ce8211ddec11d504099c99b077a90877a18077a708379a00772d0033d180774908777708777d0033da08774688772f8057878877470077a4041894c65a09c4e84a25211282a5a95819259508b286598a85e042b02e544b23250542aa2cd1104c598402094858d6e8558401610ca15620159d86857880564a1a15e211690c5827e855840162f0a166201595068380340c5422c200b231d0bb1802c8a941c02a06521169005939a855840164b7a160142a128410ab1984e35442dc2044256b20d044c011801b2a0cc4cd438b04338ccc33cb84139b4033ce8811eccc23d84033cc0433888033b94030a00d4a50b9d48452f0000006306600ac60c534f046306b8108b60cc202b79108c1956e62682318318f1413066f0a53d08c60c39050fc19821c5ec211833fc9b1f0413307cc0033bf8053ba08336a8077758077778877b70873660877470877ac08736380777a8870d65500e6dd00e7a500e6d900e7640077a600774d006e6800770a00771200778d006ee80077a100776a0077320077a600774d006b310077280074a0f08111242868c141101344218d6609c815a881d50df11c1f00a4900004000000000ec8042cf1b065848020000020000006007f47b4631e04212000010000000003ba0f2338e21179200008000000000d801ad9f910cba9004000004000000c00e28febc618885240000200000000076402f1818c9b00b4900004000000000ec806a30f08641169200008000000000d801cd616024032f2401000001000000b003cac3c01b865948020000020000006007748b81910cbd9004000004000000c00ea817036f18682109000008000000801dd03e064632f84212000010000000003ba0900cbc61a885240000200000000076403f1918c9f00b4900004000000000ec80ca32f086c1169200008000000000d8018d66602403382401000001000000b0034acdc01b865b48020000020000006007749ec1910ce19004000004000000c010c93d838801002000000000000000c4011822fd67403940000000000000000000000c916634302220000400000000000000008648391a581b1000030000400000000000432460ea00602204000002000800001822bd6940061f100005000000000000000043a4590db0300002c000000000000000006088b4ae41350640001c00000000000000000c914036983a20000a00008000000000008648534fa001004c0800000000000200004324b8108b3500802901000000006000006088242b79b00600301102000000001000000c916636f0da00080001000000000000008021d2cadcc41a00c0940800000000500000304412233e580300980801000000000c00008648beb407700000932200001000c00100c01029a7e0410e00602204000000004000001822a5983dd001004c08000000000009000043a4b80db23b00026001000000000000006088f46f7e000700302902000001002800000c9154378818000002000000000000401c8021d2ee065818000160000000000000000030449adf20620000080000000000000071008648241c60610004800100000000000000c0108987838801002000000000000000c4011822b571808501100006000000000000000043a4520e22060080000000000000001007608864cb01160640001800000000000000000c91dc398818000002000000000000401c8021d23f07581800016000000000000000003044bae920620000080000000000000071008648681d60610004800100000000000000c01009b4838801002000000000000000c4011822c576808501100006000000000000000043a4f40e2206008000000000000000008021927e074b1e000100000000000000000030442af180d90320000000000000000000008648311e347d0004000000000000000000c010c9c703e70f80000000000000000000001822b179d08402100000000000000000000043a43c0f9c510002000000000000000000608874ea01730a40000000000000000000000c91663d68520108000000000000000000802112b8074d2b000100000000000000000030446af7c0790520000000000000000000008648fb1e18b10004000000000000000000c01029e4038c1600000000000000000000001822e57c80d102000000000000000000000043a4b80f305a0000000000000000000000608894fa01460b00000000000000000000000c91c23fc0680100000000000000000000802152fe07182d000000000000000000000030448a4101a30500000000000000000000008648692860b40000000000000000000000c0102914058c1600000000000000000000001822e5a210d902000000000000000000000043247514085b00020000000000000000004062834061e70600802c1038000000321e981c19114c908c092647c604435a9440215040b7d21c9476c3eb7450909d1e9775a01219247c8b75a0125941835d5a429a52222ab461d8a525a42925a282a5825d5a429a52222a4c6ad9a525a42925a2a243aa5d5a429a52222a4c67d8a525a42925a2426b865d5a429a52222ad028daa525a42925a2c273222ae81b94e6a01219444fb7cb731688fea687d9a0f17b4e47d5e7291da8640685ed6579f85c46d5e7291da864a68376a539485e9ed7d974542fc84e8fcba0d21c247c8b533a5089aca084062b0d5a1aa834786950d2c0a4015f032f416c1f14841d01000000b1180000740000003308801cc4e11c6614013d88433884c38c4280077978077398710ce6000fed100ef4800e330c421ec2c11dcea11c6630053d88433884831bcc033dc8433d8c033dcc788c7470077b08077948877070077a700376788770208719cc110eec900ee1300f6e300fe3f00ef0500e3310c41dde211cd8211dc2611e6630893bbc833bd04339b4033cbc833c84033bccf0147660077b680737688772680737808770908770600776280776f8057678877780875f08877118877298877998812ceef00eeee00ef5c00eec300362c8a11ce4a11ccca11ce4a11cdc611cca211cc4811dca6106d6904339c84339984339c84339b8c33894433888033b94c32fbc833cfc823bd4033bb0c30cc7698770588772708374680778608774188774a08719ce530fee000ff2500ee4900ee3400fe1200eec500e3320281ddcc11ec2411ed2211cdc811edce01ce4e11dea011e66185138b0433a9c833bcc50247660077b68073760877778077898514cf4900ff0500e331e6a1eca611ce8211ddec11d7e011ee4a11ccc211df0610654858338ccc33bb0433dd04339fcc23ce4433b88c33bb0c38cc50a877998877718877408077a28077298815ce3100eecc00ee5500ef33023c1d2411ee4e117d8e11dde011e00000000792000003c000000621e482043880c19391924909140c6c8c86822500814329e18192147c89051148898000023a10000636c616e672076657273696f6e20362e302e312028746167732f52454c454153455f3630312f66696e616c292028676974403139322e3136382e392e36363a506c61744f4e2f706c61746f6e2d636f6d70696c65722e67697420643637373763633130363134353731316137656439613335343538386566666262623135363034652977636861725f73697a6500000023080b2b8c202cad304310cc300c02212381094a858dcdaecd258daccc8d6e9480c8888dcdaecda5ed8dac8eadccc58c2dec6c6e94a00000a91800000b0000000b0a7228877780077a587098433db8c338b04339d0c382e61cc6a10de8411ec2c11de6211de8211ddec11d00d11000000600000007cc3ca4833b9c033b94033da0833c94433890c30100000061200000bd0000001304582c1000000015000000b4180128604d862220c850c740044b392ce530d41108c0520e4b390c751486b094c3520e431d07322ce5b094c35047a2104b392ce540cb310210044110044110e4ff618c00044110044198a45791a0ed0c0000003311cbc20aa33013b12cac300a3311cbc20aa33013812dac400a3311d8c20aa43013012dac000a3311cbc20aa03013812dac400a331166b0b00229cc442c0b2b8cc24c04b6b00229cc4498c1c20aa4301351060b2b90c24c44192cac400a3311cbc20aa3306c403cdc000c1b10ce3600c30644930d003d8b41cf628c182000088241c40e582604230607038260b0b1c323d9c13409038248806cece044db34070082889074ebb08c18100d0882c1a70edb342c9eb74b43f07dc306443010c0b001c180c100cc120cc42c06518b31dc20046830cb4030c13489038248a184c13b3815350df28020622c63e00e91336250342008069d3b3cb30407418b61811f80c0b001210503304b30cc1b0cbb1000a30901306c406001018c2608c1b001810503304b60cd1b0cbb1000a30901306c406c01018c2608c1b001b10503304b50cd1b0cbb1000a30901306c407801018c2608c1b001e10503304b40cd1b0cbb1000a30901306c4084414000a30942306c4084413000230645038260d0f143374b408d18100d0882c1f70fdb3474733007bb3404744007c306443010c03408048248a3a0813f7c62b04b83670776306c400402014c7344208838ca1afcc3b74b4318e0011e0c1b10814000c4068b31cd018020f2286b10126370c1d22aa003a9800e689a0300410452d6a024cee082a555800752011e10d5c1625cb0b41a029a660140108994a8264041141824980601401091943660093a30850b16306c40bc413000f4068b318d0280203229514e8c822988424071b018230645038260d0d5441e8c18140d08824157137c306250342008065d4df44106230645038260d0d5441ecc1254230645038260d0d5041fcc1258230645038260d0d5441fcc125cb40710427bb018b30da32000b30d8110cc19040100000061200000100000001304412c1000000002000000b41801a0cb0800003311d9c20aa4306c400404015090211778f704ef6ecc3018c6b001111c04b03103717cc3064470100002000061200000240000001304412c1000000001000000b4180100331165b0b00229cc449cc1c20aa4301371060b2b90c24c44192cac400a331165b0b002290c1b10044200c306c470100011273262500020080672900ac12e0d04820c1b10814000649cc8884101802018c8012b04bb3418cb326c400402018c1818100882011db40272ecd2c034cdb001110804b04b43e338145048060000000061200000120000001304412c1000000001000000b4180100331165b0b00229cc44a8c1c20aa4306c4004040150a022230645048260b006a810ecd24014c5b001110804b04b4361181450480600000000612000000b0000001304412c1000000001000000b418010033116ab0b002290c1b10c1400014a8c82e0dc130504021190000000061200000160000001304412c1000000002000000b41801204a413f00331165b0b00229cc44a8c1c20aa43013412dac400ac30684601000092a326250002008066b900a4105060d1b104440002306860482600007aa6010bb3418084201856400612000000b0000001304412c1000000001000000b418010033116ab0b002290c1b10c1400014a8c82e0dc130504021190000000061200000100000001304412c1000000001000000b418010033116ab0b00229cc44bcc1c20aa4306c400805010c1b1001410024a8c82e0d0141d0f0221450c8b0013104048000000061200000140000001304412c1000000003000000b418012808a21404d9460000331165b0b00229cc449cc1c20aa4306c40040701507022db3404c77104644f80ec884102802018dc412a0801921cbb34188a420185640000612000002b0000001304412c1000000003000000b428881100a21404d9460000331165b0b00229cc44a8c1c20aa43013a1060b2b90c24c04b5b00229cc4494c1c20aa4301351060b2b90c2b001513004306c40100b0150a1223740f604c88e1824000882c11db482102c8d326250002008066b100b05212a7206644f80ec884102802018dc412c08c11339230605008260b006b580581184c0b001c104043062604820080670200b0fb34bc3234914504806000061200000100000001304412c1000000001000000b418010033116ab0b00229cc44bcc1c20aa4306c400805010c1b1001410024a8c82e0d0141d0f0221450c8b0013104048000000061200000bd0000001304582c1000000015000000b4180128604d862220c850c740144b392ce530d41108c0520e4b390c751486b094c3520e431d07322ce5b094c35047a2184b392ce540cb310210044110044110e4ff618c00044110044198a45791a0ed0c0000003311cbc20aa33013b12cac300a3311cbc20aa33013812dac400a3311d8c20aa43013012dac000a3311cbc20aa03013812dac400a331166b0b00229cc442c0b2b8cc24c04b6b00229cc4498c1c20aa4301351060b2b90c24c44192cac400a3311cbc20aa3306c403cdc000c1b10ce3600c30644930d003d8b41cf628c182000088241c40e582604230607038260b0b1c323d9c13409038248806cece044db34070082889074ebb08c18100d0882c1a70edb342c9eb74b43f07dc306443010c0b001c180c100cc120cc42c06518b31dc20046830cb4030c13489038248a18401383815350df28020622c63e00e91336250342008069d3b3cb30407418b61811f80c0b001210503304b30cc1b0cbb1000a30901306c406001018c2608c1b001810503304b60cd1b0cbb1000a30901306c406c01018c2608c1b001b10503304b50cd1b0cbb1000a30901306c407801018c2608c1b001e10503304b40cd1b0cbb1000a30901306c4084414000a30942306c4084413000230645038260d0f143374b408d18100d0882c1f70fdb3474733007bb3404744007c306443010c03408048248a3a0813f7c62b04b83670776306c400402014c7344208838ca1afcc3b74b4318e0011e0c1b10814000c4068b31cd018020f2286b10126370c1d22aa003a9800e689a0300410452d6a024cee082a555800752011e10d5c1625cb0b41a029a660140108994a8264041141824980601401091943660093a30850b16306c40bc413000f4068b318d0280203229514e8c822988424071b018230645038260d0d5441e8c18140d08824157137c306250342008065d4df44106230645038260d0d5441ecc1254230645038260d0d5041fcc1258230645038260d0d5441fcc125cb40710427bb018b30da32000b30d8110cc19040100000061200000bd0000001304582c1000000015000000b4180128604d862220c850c7401c4b392ce530d41108c0520e4b390c751486b094c3520e431d07322ce5b094c35047a2204b392ce540cb310210044110044110e4ff618c00044110044198a45791a0ed0c0000003311cbc20aa33013b12cac300a3311cbc20aa33013812dac400a3311d8c20aa43013012dac000a3311cbc20aa03013812dac400a331166b0b00229cc442c0b2b8cc24c04b6b00229cc4498c1c20aa4301351060b2b90c24c44192cac400a3311cbc20aa3306c403cdc000c1b10ce3600c30644930d003d8b41cf628c182000088241c40e582604230607038260b0b1c323d9c13409038248806cece044db34070082889074ebb08c18100d0882c1a70edb342c9eb74b43f07dc306443010c0b001c180c100cc120cc42c06518b31dc20046830cb4030c13489038248a184812f3815350df28020622c63e00e91336250342008069d3b3cb30407418b61811f80c0b001210503304b30cc1b0cbb1000a30901306c406001018c2608c1b001810503304b60cd1b0cbb1000a30901306c406c01018c2608c1b001b10503304b50cd1b0cbb1000a30901306c407801018c2608c1b001e10503304b40cd1b0cbb1000a30901306c4084414000a30942306c4084413000230645038260d0f143374b408d18100d0882c1f70fdb3474733007bb3404744007c306443010c03408048248a3a0813f7c62b04b83670776306c400402014c7344208838ca1afcc3b74b4318e0011e0c1b10814000c4068b31cd018020f2286b10126370c1d22aa003a9800e689a0300410452d6a024cee082a555800752011e10d5c1625cb0b41a029a660140108994a8264041141824980601401091943660093a30850b16306c40bc413000f4068b318d0280203229514e8c822988424071b018230645038260d0d5441e8c18140d08824157137c306250342008065d4df44106230645038260d0d5441ecc1254230645038260d0d5041fcc1258230645038260d0d5441fcc125cb40710427bb018b30da32000b30d8110cc19040100000061200000bd0000001304582c1000000015000000b4180128604d862220c850c740244b392ce530d41108c0520e4b390c751486b094c3520e431d07322ce5b094c35047a2284b392ce540cb310210044110044110e4ff618c00044110044198a45791a0ed0c0000003311cbc20aa33013b12cac300a3311cbc20aa33013812dac400a3311d8c20aa43013012dac000a3311cbc20aa03013812dac400a331166b0b00229cc442c0b2b8cc24c04b6b00229cc4498c1c20aa4301351060b2b90c24c44192cac400a3311cbc20aa3306c403cdc000c1b10ce3600c30644930d003d8b41cf628c182000088241c40e582604230607038260b0b1c323d9c13409038248806cece044db34070082889074ebb08c18100d0882c1a70edb342c9eb74b43f07dc306443010c0b001c180c100cc120cc42c06518b31dc20046830cb4030c13489038248a184012f3815350df28020622c63e00e91336250342008069d3b3cb30407418b61811f80c0b001210503304b30cc1b0cbb1000a30901306c406001018c2608c1b001810503304b60cd1b0cbb1000a30901306c406c01018c2608c1b001b10503304b50cd1b0cbb1000a30901306c407801018c2608c1b001e10503304b40cd1b0cbb1000a30901306c4084414000a30942306c4084413000230645038260d0f143374b408d18100d0882c1f70fdb3474733007bb3404744007c306443010c03408048248a3a0813f7c62b04b83670776306c400402014c7344208838ca1afcc3b74b4318e0011e0c1b10814000c4068b31cd018020f2286b10126370c1d22aa003a9800e689a0300410452d6a024cee082a555800752011e10d5c1625cb0b41a029a660140108994a8264041141824980601401091943660093a30850b16306c40bc413000f4068b318d0280203229514e8c822988424071b018230645038260d0d5441e8c18140d08824157137c306250342008065d4df44106230645038260d0d5441ecc1254230645038260d0d5041fcc1258230645038260d0d5441fcc125cb40710427bb018b30da32000b30d8110cc19040100000061200000bd0000001304582c1000000015000000b4180128604d862220c850c7402c4b392ce530d41108c0520e4b390c751486b094c3520e431d07322ce5b094c35047a2304b392ce540cb310210044110044110e4ff618c00044110044198a45791a0ed0c0000003311cbc20aa33013b12cac300a3311cbc20aa33013812dac400a3311d8c20aa43013012dac000a3311cbc20aa03013812dac400a331166b0b00229cc442c0b2b8cc24c04b6b00229cc4498c1c20aa4301351060b2b90c24c44192cac400a3311cbc20aa3306c403cdc000c1b10ce3600c30644930d003d8b41cf628c182000088241c40e582604230607038260b0b1c323d9c13409038248806cece044db34070082889074ebb08c18100d0882c1a70edb342c9eb74b43f07dc306443010c0b001c180c100cc120cc42c06518b31dc20046830cb4030c13489038248a184812e3815350df28020622c63e00e91336250342008069d3b3cb30407418b61811f80c0b001210503304b30cc1b0cbb1000a30901306c406001018c2608c1b001810503304b60cd1b0cbb1000a30901306c406c01018c2608c1b001b10503304b50cd1b0cbb1000a30901306c407801018c2608c1b001e10503304b40cd1b0cbb1000a30901306c4084414000a30942306c4084413000230645038260d0f143374b408d18100d0882c1f70fdb3474733007bb3404744007c306443010c03408048248a3a0813f7c62b04b83670776306c400402014c7344208838ca1afcc3b74b4318e0011e0c1b10814000c4068b31cd018020f2286b10126370c1d22aa003a9800e689a0300410452d6a024cee082a555800752011e10d5c1625cb0b41a029a660140108994a8264041141824980601401091943660093a30850b16306c40bc413000f4068b318d0280203229514e8c822988424071b018230645038260d0d5441e8c18140d08824157137c306250342008065d4df44106230645038260d0d5441ecc1254230645038260d0d5041fcc1258230645038260d0d5441fcc125cb40710427bb018b30da32000b30d8110cc19040100000061200000bd0000001304582c1000000015000000b4180128604d862220c850c740344b392ce530d41108c0520e4b390c751486b094c3520e431d07322ce5b094c35047a2384b392ce540cb310210044110044110e4ff618c00044110044198a45791a0ed0c0000003311cbc20aa33013b12cac300a3311cbc20aa33013812dac400a3311d8c20aa43013012dac000a3311cbc20aa03013812dac400a331166b0b00229cc442c0b2b8cc24c04b6b00229cc4498c1c20aa4301351060b2b90c24c44192cac400a3311cbc20aa3306c403cdc000c1b10ce3600c30644930d003d8b41cf628c182000088241c40e582604230607038260b0b1c323d9c13409038248806cece044db34070082889074ebb08c18100d0882c1a70edb342c9eb74b43f07dc306443010c0b001c180c100cc120cc42c06518b31dc20046830cb4030c13489038248a184012e3815350df28020622c63e00e91336250342008069d3b3cb30407418b61811f80c0b001210503304b30cc1b0cbb1000a30901306c406001018c2608c1b001810503304b60cd1b0cbb1000a30901306c406c01018c2608c1b001b10503304b50cd1b0cbb1000a30901306c407801018c2608c1b001e10503304b40cd1b0cbb1000a30901306c4084414000a30942306c4084413000230645038260d0f143374b408d18100d0882c1f70fdb3474733007bb3404744007c306443010c03408048248a3a0813f7c62b04b83670776306c400402014c7344208838ca1afcc3b74b4318e0011e0c1b10814000c4068b31cd018020f2286b10126370c1d22aa003a9800e689a0300410452d6a024cee082a555800752011e10d5c1625cb0b41a029a660140108994a8264041141824980601401091943660093a30850b16306c40bc413000f4068b318d0280203229514e8c822988424071b018230645038260d0d5441e8c18140d08824157137c306250342008065d4df44106230645038260d0d5441ecc1254230645038260d0d5041fcc1258230645038260d0d5441fcc125cb40710427bb018b30da32000b30d8110cc19040100000061200000bd0000001304582c1000000015000000b4180128604d862220c850c7403c4b392ce530d41108c0520e4b390c751486b094c3520e431d07322ce5b094c35047a2404b392ce540cb310210044110044110e4ff618c00044110044198a45791a0ed0c0000003311cbc20aa33013b12cac300a3311cbc20aa33013812dac400a3311d8c20aa43013012dac000a3311cbc20aa03013812dac400a331166b0b00229cc442c0b2b8cc24c04b6b00229cc4498c1c20aa4301351060b2b90c24c44192cac400a3311cbc20aa3306c403cdc000c1b10ce3600c30644930d003d8b41cf628c182000088241c40e582604230607038260b0b1c323d9c13409038248806cece044db34070082889074ebb08c18100d0882c1a70edb342c9eb74b43f07dc306443010c0b001c180c100cc120cc42c06518b31dc20046830cb4030c13489038248a184812d3815350df28020622c63e00e91336250342008069d3b3cb30407418b61811f80c0b001210503304b30cc1b0cbb1000a30901306c406001018c2608c1b001810503304b60cd1b0cbb1000a30901306c406c01018c2608c1b001b10503304b50cd1b0cbb1000a30901306c407801018c2608c1b001e10503304b40cd1b0cbb1000a30901306c4084414000a30942306c4084413000230645038260d0f143374b408d18100d0882c1f70fdb3474733007bb3404744007c306443010c03408048248a3a0813f7c62b04b83670776306c400402014c7344208838ca1afcc3b74b4318e0011e0c1b10814000c4068b31cd018020f2286b10126370c1d22aa003a9800e689a0300410452d6a024cee082a555800752011e10d5c1625cb0b41a029a660140108994a8264041141824980601401091943660093a30850b16306c40bc413000f4068b318d0280203229514e8c822988424071b018230645038260d0d5441e8c18140d08824157137c306250342008065d4df44106230645038260d0d5441ecc1254230645038260d0d5041fcc1258230645038260d0d5441fcc125cb40710427bb018b30da32000b30d8110cc19040100000061200000bd0000001304582c1000000015000000b4180128604d862220c850c740444b392ce530d41108c0520e4b390c751486b094c3520e431d07322ce5b094c35047a2484b392ce540cb310210044110044110e4ff618c00044110044198a45791a0ed0c0000003311cbc20aa33013b12cac300a3311cbc20aa33013812dac400a3311d8c20aa43013012dac000a3311cbc20aa03013812dac400a331166b0b00229cc442c0b2b8cc24c04b6b00229cc4498c1c20aa4301351060b2b90c24c44192cac400a3311cbc20aa3306c403cdc000c1b10ce3600c30644930d003d8b41cf628c182000088241c40e582604230607038260b0b1c323d9c13409038248806cece044db34070082889074ebb08c18100d0882c1a70edb342c9eb74b43f07dc306443010c0b001c180c100cc120cc42c06518b31dc20046830cb4030c13489038248a184012d3815350df28020622c63e00e91336250342008069d3b3cb30407418b61811f80c0b001210503304b30cc1b0cbb1000a30901306c406001018c2608c1b001810503304b60cd1b0cbb1000a30901306c406c01018c2608c1b001b10503304b50cd1b0cbb1000a30901306c407801018c2608c1b001e10503304b40cd1b0cbb1000a30901306c4084414000a30942306c4084413000230645038260d0f143374b408d18100d0882c1f70fdb3474733007bb3404744007c306443010c03408048248a3a0813f7c62b04b83670776306c400402014c7344208838ca1afcc3b74b4318e0011e0c1b10814000c4068b31cd018020f2286b10126370c1d22aa003a9800e689a0300410452d6a024cee082a555800752011e10d5c1625cb0b41a029a660140108994a8264041141824980601401091943660093a30850b16306c40bc413000f4068b318d0280203229514e8c822988424071b018230645038260d0d5441e8c18140d08824157137c306250342008065d4df44106230645038260d0d5441ecc1254230645038260d0d5041fcc1258230645038260d0d5441fcc125cb40710427bb018b30da32000b30d8110cc190401000000612000002b0000001304412c1000000001000000b41801003311cbc20aa33013b12cac300ac30684500cc0b00111100340c26290b018230606008260c0dc821050b118542cc688810180201830a62004842c06218b31626000200806cc2908012d8b41cb628c181800088201830a4240ce6290b318230606008260c0a4821050b418142dc688810180201830aa2004442d06518b31626000200806cc2a08015d8b41d7628c181800088201c30a42901b0000000061200000220000001304412c1000000003000000b418012820a21410000000003311cbc20aa0b02082415000016b211c06050b306270002008067d6007435090b1003311cbc20aa0b0204253061440c05a08ce1950b000230607008260d0077d300405190b306260002008060c3920c1884101802018c4021e40c306841500c088c101802018fc01280492901300000061200000220000001304412c1000000003000000b418012820a21410000000003311cbc20aa0b02082415000016b211c06050b306270002008067d6007435090b1003311cbc20aa0b0204253061440c05a08ce1950b000230607008260d0077d300405190b306260002008060c2c20c1884101802018c4021e40c306841500c088c101802018fc01280492901300000061200000220000001304412c1000000003000000b418012820a21410000000003311cbc20aa0b02082415000016b211c06050b306270002008067d6007435090b1003311cbc20aa0b0204253061440c05a08ce1950b000230607008260d0077d300405190b306260002008068c2b20c1884101802018c4021e40c306841500c088c101802018fc01280492901300000061200000220000001304412c1000000003000000b418012820a21410000000003311cbc20aa0b02082415000016b211c06050b306270002008067d6007435090b1003311cbc20aa0b0204253061440c05a08ce1950b000230607008260d0077d300405190b306260002008060c2b20c1884101802018c4021e40c306841500c088c101802018fc01280492901300000061200000220000001304412c1000000003000000b418012820a21410000000003311cbc20aa0b02082415000016b211c06050b306270002008067d6007435090b1003311cbc20aa0b0204253061440c05a08ce1950b000230607008260d0077d300405190b306260002008068c2a20c1884101802018c4021e40c306841500c088c101802018fc01280492901300000061200000220000001304412c1000000003000000b418012820a21410000000003311cbc20aa0b02082415000016b211c06050b306270002008067d6007435090b1003311cbc20aa0b0204253061440c05a08ce1950b000230607008260d0077d300405190b306260002008060c2a20c1884101802018c4021e40c306841500c088c101802018fc01280492901300000061200000220000001304412c1000000003000000b418012820a21410000000003311cbc20aa0b02082415000016b211c06050b306270002008067d6007435090b1003311cbc20aa0b0204253061440c05a08ce1950b000230607008260d0077d300405190b306260002008068c2920c1884101802018c4021e40c306841500c088c101802018fc01280492901300000061200000220000001304412c1000000003000000b418012820a21410000000003311cbc20aa0b02082415000016b211c06050b306270002008067d6007435090b1003311cbc20aa0b0204253061440c05a08ce1950b000230607008260d0077d300405190b306260002008060c2920c1884101802018c4021e40c306841500c088c101802018fc01280492901300000061200000220000001304412c1000000003000000b418012820a21410000000003311cbc20aa0b02082415000016b211c06050b306270002008067d6007435090b1003311cbc20aa0b0204253061440c05a08ce1950b000230607008260d0077d300405190b306260002008068c2820c1884101802018c4021e40c306841500c088c101802018fc01280492901300000061200000040000001304c1884101842018d8421620000000712000001b000000320e10228413fa0a7891cb801ccb0cd811cf801e850d0822d98021aa0d2872db8023c90d48f2dd80268c0e78e2e98029dd0fb8c219812ddb12f8a2498131d9153883798135d7181844988142a81938c49c8144f0195844a98146b81a78c4ad8148801b9844ba814ac81b000000000000650c0000f3010000120394a01f000000010000006e080000110000004400000001000000500000000a000000a00000004c000000c0070000000000007f080000180000009708000006000000f409000000000000000000004c000000000000000000000013000000130000009d000000b0000000a200000052010000390000008b01000097000000220200003c0000005e0200003b000000990200007000000009030000760000007f0300003e000000ee04000011000000ee04000011000000ffffffff00240000ff04000014000000ff04000014000000ffffffff0824000013050000060000001305000006000000ffffffff0824000019050000160000001905000016000000ffffffff083400000000000013000000000000001300000000000000103600002f050000240000002f05000024000000ffffffff0824000053050000180000005305000018000000ffffffff082400006b050000150000006b05000015000000ffffffff0824000080050000130000008005000013000000ffffffff08340000130000009d000000130000009d0000000100000010240000b0000000a2000000b0000000a20000000200000010240000520100003900000052010000390000000300000010240000930500001e000000930500001e000000ffffffff082400008b010000970000008b010000970000000400000010240000220200003c000000220200003c00000005000000102400005e0200003b0000005e0200003b0000000600000010360000990200007000000099020000700000000700000010240000090300007600000009030000760000000800000010240000b105000019000000b105000019000000ffffffff082c00007f0300003e0000007f0300003e0000000900000010360000ca05000011000000ca05000011000000ffffffff00240000db05000018000000db05000018000000ffffffff08240000f305000011000000f305000011000000ffffffff0024000004060000180000000406000018000000ffffffff082400001c060000110000001c06000011000000ffffffff002400002d060000180000002d06000018000000ffffffff0824000045060000110000004506000011000000ffffffff0024000056060000180000005606000018000000ffffffff082400006e060000110000006e06000011000000ffffffff002400007f060000180000007f06000018000000ffffffff0824000097060000110000009706000011000000ffffffff00240000a806000018000000a806000018000000ffffffff08240000c006000011000000c006000011000000ffffffff00240000d106000018000000d106000018000000ffffffff08240000e906000011000000e906000011000000ffffffff00240000fa0600000b000000fa0600000b000000ffffffff08240000050700000c000000050700000c000000ffffffff08240000110700000d000000110700000d000000ffffffff082400001e0700000e0000001e0700000e000000ffffffff082400002c0700000d0000002c0700000d000000ffffffff08240000390700000e000000390700000e000000ffffffff08240000470700000c000000470700000c000000ffffffff08240000530700000d000000530700000d000000ffffffff08240000600700000d000000600700000d000000ffffffff082400006d0700000e0000006d0700000e000000ffffffff082400007b070000060000007b07000006000000ffffffff0824000081070000180000008107000018000000ffffffff0024000099070000180000009907000018000000ffffffff00240000b107000018000000b107000018000000ffffffff00240000c907000018000000c907000018000000ffffffff00240000e107000018000000e107000018000000ffffffff00240000f907000018000000f907000018000000ffffffff0024000011080000180000001108000018000000ffffffff0024000029080000180000002908000018000000ffffffff0024000041080000180000004108000018000000ffffffff0024000059080000110000005908000011000000ffffffff002400006a080000040000006a08000004000000ffffffff082400009d08000006000000bd03000004000000ffffffff00180000a308000020000000c10300001e000000ffffffff00180000c308000008000000df03000006000000ffffffff00180000cb08000008000000e503000006000000ffffffff00180000d308000008000000eb03000006000000ffffffff00180000db08000020000000f10300001e000000ffffffff00180000fb080000080000000f04000006000000ffffffff001800000309000020000000150400001e000000ffffffff0018000023090000080000003304000006000000ffffffff001800002b09000020000000390400001e000000ffffffff001800004b090000080000005704000006000000ffffffff0018000053090000200000005d0400001e000000ffffffff0018000073090000080000007b04000006000000ffffffff001800007b09000020000000810400001e000000ffffffff001800009b090000080000009f04000006000000ffffffff00180000a309000020000000a50400001e000000ffffffff00180000c309000008000000c304000006000000ffffffff00180000cb09000020000000c90400001e000000ffffffff00180000eb09000009000000e704000007000000ffffffff00180000000000005d0c000080020000120394f42b0000005f5a4e33656d7037496e7465676572433245765f5a4e5374366368726f6e6f6d69494e535f335f5632313273797374656d5f636c6f636b454e535f386475726174696f6e496c537435726174696f494c6c31454c6c313030303030303030304545454553365f45454e53743131636f6d6d6f6e5f74797065494a54305f54315f4545347479706545524b4e535f313074696d655f706f696e7449545f53385f4545524b4e53435f4953445f53395f45455f5a4e5374366368726f6e6f31336475726174696f6e5f63617374494e535f386475726174696f6e496c537435726174696f494c6c31454c6c31303030303030454545456c53325f494c6c31454c6c31303030303030303030454545454e537439656e61626c655f69664958737231335f5f69735f6475726174696f6e49545f45453576616c75654553375f45347479706545524b4e53315f4954305f54315f45455f5a4e4b5374366368726f6e6f386475726174696f6e496c537435726174696f494c6c31454c6c3130303030303045454535636f756e7445765f5a4e5374366368726f6e6f32305f5f6475726174696f6e5f636173745f696d706c494e535f386475726174696f6e496c537435726174696f494c6c31454c6c313030303030304545454553325f494c6c31454c6c3130303045456c4c6231454c62304545365f5f63617374496c53325f494c6c31454c6c313030303030303030304545454553345f524b4e53315f49545f54305f45455f5a4e4b5374366368726f6e6f386475726174696f6e496c537435726174696f494c6c31454c6c3130303030303030303045454535636f756e7445765f5a4e5374366368726f6e6f386475726174696f6e496c537435726174696f494c6c31454c6c313030303030304545454332496c764545524b545f5f5a4e4b5374366368726f6e6f313074696d655f706f696e74494e535f335f5632313273797374656d5f636c6f636b454e535f386475726174696f6e496c537435726174696f494c6c31454c6c313030303030303030304545454545313674696d655f73696e63655f65706f636845765f5a4e5374366368726f6e6f6d69496c537435726174696f494c6c31454c6c3130303030303030303045456c53325f45454e53743131636f6d6d6f6e5f74797065494a4e535f386475726174696f6e49545f54305f45454e53345f4954315f54325f45454545347479706545524b53375f524b53415f5f5a4e5374366368726f6e6f386475726174696f6e496c537435726174696f494c6c31454c6c313030303030303030304545454332496c764545524b545f2e7374725f5f46554e4354494f4e5f5f2e5f5a3131546573745065726641646469692e7374722e312e7374722e322e7374722e335f5f46554e4354494f4e5f5f2e5f5a3131546573745065726653756269692e7374722e345f5f46554e4354494f4e5f5f2e5f5a313154657374506572664d756c69692e7374722e355f5f46554e4354494f4e5f5f2e5f5a3131546573745065726644697669692e7374722e365f5f46554e4354494f4e5f5f2e5f5a313154657374506572664d6f6469692e7374722e375f5f46554e4354494f4e5f5f2e5f5a31315465737450657266416e6469692e7374722e385f5f46554e4354494f4e5f5f2e5f5a313154657374506572664f727269692e7374722e395f5f46554e4354494f4e5f5f2e5f5a31315465737450657266456f7269692e7374722e31305f5a3131546573745065726641646469695f5f6778785f706572736f6e616c6974795f76307072696e74665f5a4e33656d7037496e7465676572433145524b69695f5a4e5374366368726f6e6f335f5632313273797374656d5f636c6f636b336e6f7745765f5a4e4b33656d7037496e7465676572706c45524b53305f5f5a4e33656d7037496e746567657261534553305f5f5a4e33656d7037496e7465676572443145765f5a4e4b33656d7037496e7465676572313072657665616c5f696e7445696c6c766d2e6d656d6370792e703069382e703069382e6936345f5a3131546573745065726653756269695f5a4e4b33656d7037496e74656765726d6945524b53305f5f5a313154657374506572664d756c69695f5a4e4b33656d7037496e74656765726d6c45524b53305f5f5a3131546573745065726644697669695f5a4e4b33656d7037496e7465676572647645524b53305f5f5a313154657374506572664d6f6469695f5a4e4b33656d7037496e7465676572726d45524b53305f5f5a31315465737450657266416e6469695f5a4e4b33656d7037496e7465676572616e45524b53305f5f5a313154657374506572664f727269695f5a4e4b33656d7037496e74656765726f7245524b53305f5f5a31315465737450657266456f7269695f5a4e4b33656d7037496e7465676572656f45524b53305f5f5a31315465737450657266416c6c696952656164566172426f6f6c5772697465566172426f6f6c5265616456617255696e743332577269746556617255696e7433325265616456617255696e743634577269746556617255696e74363452656164566172466c6f61745772697465566172466c6f617452656164566172446f75626c655772697465566172446f75626c656d616c6c6f63506c61744f4e5f656e7472795f5465737450657266416464506c61744f4e5f656e7472795f5465737450657266537562506c61744f4e5f656e7472795f54657374506572664d756c506c61744f4e5f656e7472795f5465737450657266446976506c61744f4e5f656e7472795f54657374506572664d6f64506c61744f4e5f656e7472795f5465737450657266416e64506c61744f4e5f656e7472795f54657374506572664f7272506c61744f4e5f656e7472795f5465737450657266456f72506c61744f4e5f656e7472795f5465737450657266416c6c506c61744f4e5f656e7472795f6672656566726565362e302e31206769742d643637373763637838365f36342d756e6b6e6f776e2d6c696e75782d676e756d6f64756c652e4c2e7374722e4c5f5f46554e4354494f4e5f5f2e5f5a3131546573745065726641646469692e4c2e7374722e312e4c2e7374722e322e4c2e7374722e332e4c5f5f46554e4354494f4e5f5f2e5f5a3131546573745065726653756269692e4c2e7374722e342e4c5f5f46554e4354494f4e5f5f2e5f5a313154657374506572664d756c69692e4c2e7374722e352e4c5f5f46554e4354494f4e5f5f2e5f5a3131546573745065726644697669692e4c2e7374722e362e4c5f5f46554e4354494f4e5f5f2e5f5a313154657374506572664d6f6469692e4c2e7374722e372e4c5f5f46554e4354494f4e5f5f2e5f5a31315465737450657266416e6469692e4c2e7374722e382e4c5f5f46554e4354494f4e5f5f2e5f5a313154657374506572664f727269692e4c2e7374722e392e4c5f5f46554e4354494f4e5f5f2e5f5a31315465737450657266456f7269692e4c2e7374722e313000000000"

/// Starter -> INVITOR_VALUE_TEMPLATE
#define INVITOR_VALUE "0x60ceca9c1290ee56b98d4e160ef0453f7c40d219"

/// Participator, use symbol '&' to split, eg:a&b&c -> PARTIES_VALUE_TEMPLATE
#define PARTIES_VALUE "0x60ceca9c1290ee56b98d4e160ef0453f7c40d219&0x3771c08952f96e70af27324de11bb380ec388ec3"

/// Urls for participators, use symbol '&' to split.
/// URLS -> URLS_VALUE_TEMPLATE
#define URLS_VALUE "0x60ceca9c1290ee56b98d4e160ef0453f7c40d219$DirectNodeServer:default -h 10.10.8.20 -p 10001,0x3771c08952f96e70af27324de11bb380ec388ec3$DirectNodeServer:default -h 10.10.8.20 -p 10002"

/// Rule of allocation.
/// format:k1:v1,k2:v2,k3:v3 -> PROFIT_RULES_VALUE
#define PROFIT_RULES_VALUE "0x60ceca9c1290ee56b98d4e160ef0453f7c40d219:1,0x3771c08952f96e70af27324de11bb380ec388ec3:2"

/// Calu method's price -> METHOD_PRICE_VALUE
/// rule:${METHOD}&${VALUE},${METHOD}&${VALUE}
/// eg:
/// func01$10000000000000000,func02$200000000000000,func03$4000000000000000000000000000
#define METHOD_PRICE_VALUE "foo_abs$200"

/// the prefix key of map struct
#define PREFIX_RULES_MAP PREFIX "_MAP_RULE_"
#define PREFIX_RESULT_MAP PREFIX "_MAP_RESULT_"
#define PREFIX_ALLOT_MAP PREFIX "_MAP_ALLOT_"
#define PREFIX_METHOD_MAP PREFIX "_MAP_PRICE_"

class MPC : public platon::Contract {
public:
  // define event.
  PLATON_EVENT(start_calc_event, uint64_t, const char *)
  PLATON_EVENT(set_result_event, uint64_t, const char *)
  PLATON_EVENT(set_fees_event, uint64_t, const char *)

  void init() {
    platon::setState(OWNER, platon::caller().toString()); // save msg.sender
    platon::setState(KEY_INVITORS, INVITOR_VALUE);        // save invitor
    platon::setState(KEY_PARTIES, PARTIES_VALUE);         // save partner
    platon::setState(KEY_URLS, URLS_VALUE);               // save all urls
    platon::setState(KEY_IR, IR_VALUE);                   // save ir data
    init_set_urls();                                      // save each one by id
    init_set_price(); // save price of method
  }

  /// get the owner address of contract.
  const char *get_owner() const {
    std::string _owner_;
    platon::getState(OWNER, _owner_);
    return _owner_.c_str();
  }

  void TestPerfAdd(const char *extra) {start_calc("TestPerfAdd", extra);}
  void TestPerfSub(const char *extra) {start_calc("TestPerfSub", extra);}
  void TestPerfMul(const char *extra) {start_calc("TestPerfMul", extra);}
  void TestPerfDiv(const char *extra) {start_calc("TestPerfDiv", extra);}
  void TestPerfMod(const char *extra) {start_calc("TestPerfMod", extra);}
  void TestPerfAnd(const char *extra) {start_calc("TestPerfAnd", extra);}
  void TestPerfOrr(const char *extra) {start_calc("TestPerfOrr", extra);}
  void TestPerfEor(const char *extra) {start_calc("TestPerfEor", extra);}
  void TestPerfAll(const char *extra) {start_calc("TestPerfAll", extra);}

  /// trigger mpc compute.
  void start_calc(const char *method, const char *extra) {

    // check msg.send is valid
    bool _isPartner = is_partner();
    if (!_isPartner) {
      platon::println("Invalid msg.sender, not belong to partners.");
      PLATON_EMIT_EVENT(start_calc_event, 0,
                        "Invalid msg.sender, not belong to partners.");
      return;
    }

    // check value is greater than preprice.
    bool is_enough_res = is_enough_price(method);
    if (!is_enough_res) {
      platon::println("insufficient value to the method of ", method);
      PLATON_EMIT_EVENT(start_calc_event, 0,
                        "Insufficient value for the method.");
      return;
    }

    // gen task id and save value
    std::string task_id_str = gen_task_id();
    const char *task_id = task_id_str.c_str();
    platon::println("New task id: ", task_id);
    bool save_res = save_allot_amount(task_id);
    if (!save_res) {
      platon::println("save allot amount fail");
      PLATON_EMIT_EVENT(start_calc_event, 0, "save allot amount fail");
      return;
    }

    // save task information. INFO_PREFIX + TASK_ID
    std::string task_key_str = KEY_TASK_INFO + task_id_str;
    std::string info_str =
        std::string(method) + COMMON_SPLIT_CHAR + std::string(extra);
    platon::println("save info for task:", "key:=", task_key_str, "info:=", info_str);
    platon::setState(task_key_str, info_str);
    platon::println("start success..");
    platon::println("Finalize task id: ", task_id);
    PLATON_EMIT_EVENT(start_calc_event, 1, task_id);
  }

  /// The result recored, and allot profit to participators.
  void set_result(const char *taskId, uint64_t status, const char *data) {
    // check msg.send is valid
    bool _isPartner = is_partner();
    if (!_isPartner) {
      platon::println(
          "set_result->Invalid msg.sender, not belong to partners.");
      PLATON_EMIT_EVENT(start_calc_event, 0,
                        "Invalid msg.sender, not belong to partners.");
      return;
    }

    std::string key_str = PREFIX_RESULT_MAP + std::string(taskId);
    // check result set
    std::string res_value_str;
    platon::getState(key_str, res_value_str);
    if (res_value_str.length() > 1) {
      platon::println("set_result-> set already. Can not reset again.");
      PLATON_EMIT_EVENT(start_calc_event, 0,
                        "set already. Can not reset again.");
      return;
    }

    // save result
    std::string status_str = toString(status);
    std::string data_str = std::string(data);
    std::string value_str = status_str + COMMON_SPLIT_CHAR + data_str;
    platon::println("save result, key: ", key_str, " value:", value_str);
    platon::setState(key_str, value_str);

    // divide the money. equal division.
    if (status != 1) { // 1 success 0 fail.
      platon::println("set_result-> status must equal 1.");
      PLATON_EMIT_EVENT(start_calc_event, 0, "status must equal 1.");
      return;
    }
    platon::u256 amount_i = get_saved_amount(taskId);
    const char *partners_c = get_participants();
    std::string partner_str = std::string(partners_c);
    std::vector<std::string> partner_vec =
        split(partner_str, COMMON_SPLIT_CHAR);

    platon::u256 count_i(partner_vec.size());

    platon::println("part per:", count_i.convert_to<std::string>());
    platon::u256 each_one_i = amount_i / count_i;
    platon::println("avg :", each_one_i.convert_to<std::string>());

    // transfer to partner
    for (unsigned int i = 0; i < partner_vec.size(); ++i) {
      std::string p_str = partner_vec[i];
      platon::println("transfer to:", p_str,
                      " value:", each_one_i.convert_to<std::string>());
      platon::Address _addr(p_str, true);
      platon::callTransfer(_addr, each_one_i);
    }
    platon::println("Set result success.");
    PLATON_EMIT_EVENT(set_result_event, 1, "Setting result success.");
  }

  /// k1:v1,k2:v2,k3:v3
  void set_fees(const char *fees) {
    platon::println("into set_fees...");
    PLATON_EMIT_EVENT(set_fees_event, 1, "set fees done.");
  }

  const char *get_ir_data() const {
    std::string irdata;
    platon::getState(KEY_IR, irdata);
    return irdata.c_str();
  }

  const char *get_participants() const {
    std::string parties;
    platon::getState(KEY_PARTIES, parties);
    platon::println("get_participants:", parties);
    return parties.c_str();
  }

  const char *get_urls() const {
    std::string urls;
    platon::getState(KEY_URLS, urls);
    return urls.c_str();
  }

  const char *get_url_by_id(const char *id) const {
    std::string url;
    std::string key_str = KEY_URLS + std::string(id);
    platon::getState(key_str, url);
    return url.c_str();
  }

  const char *get_result(const char *task_id) const {
    std::string id_str = std::string(task_id);
    std::string key_str = PREFIX_RESULT_MAP + std::string(id_str);
    std::string result;
    platon::getState(key_str, result);
    // std::string value_str = status_str + COMMON_SPLIT_CHAR + data_str;
    std::vector<std::string> partner_vec = split(result, COMMON_SPLIT_CHAR);
    if (partner_vec.size() != 2) {
      return "";
    }
    return partner_vec[1].c_str();
  }

  uint64_t get_status(const char *task_id) const {
    std::string id_str = std::string(task_id);
    std::string key_str = PREFIX_RESULT_MAP + std::string(id_str);
    std::string result;
    platon::getState(key_str, result);
    std::vector<std::string> partner_vec = split(result, COMMON_SPLIT_CHAR);
    if (partner_vec.size() != 2) {
      return 0;
    }
    uint64_t st = stouint64(partner_vec[0]);
    return st;
  }

  const char *get_fee(const char *method) const {
    platon::u256 fee;
    std::string key_str = KEY_METHOD_PRICE + std::string(method);
    platon::getState(key_str, fee);
    platon::println("call get_fee. - ", fee.convert_to<std::string>());
    return fee.convert_to<std::string>().c_str();
  }

  const char *get_invitor() const {
    std::string invitor;
    platon::getState(KEY_INVITORS, invitor);
    return invitor.c_str();
  }

private:
  std::string gen_task_id() const {
    uint64_t nonce_i = getCallerNonce();
    std::string nonce_str = toString(nonce_i);
    platon::h160 caller_h = platon::caller();
    std::string caller_h_str = caller_h.toString();
    platon::println("get nonce: ", nonce_str);
    platon::println("get caller_h_str: ", caller_h_str);
    std::string src_str = nonce_str + caller_h_str;
    char *t_src;
    strcpy(t_src, src_str.c_str());

    platon::h256 sha3_h = platon::sha3((platon::byte *)t_src, strlen(t_src));
    std::string sha3_h_str = sha3_h.toString();
    platon::println("task id : ", sha3_h_str);
    return sha3_h_str;
  }

  bool is_partner() {
    platon::h160 caller_h = platon::caller();
    std::string caller_h_str = caller_h.toString();
    std::string partner_str;
    platon::getState(KEY_PARTIES, partner_str);
    platon::println("Participator :", partner_str);
    platon::println("Caller :", caller_h_str);
    std::string::size_type idx = caller_h_str.find("0x");
    if (idx == std::string::npos) {
      caller_h_str = "0x" + caller_h_str;
    }
    platon::println("Caller End:", caller_h_str);
    std::vector<std::string> partner_vec =
        split(partner_str, COMMON_SPLIT_CHAR);
    for (unsigned int i = 0; i < partner_vec.size(); ++i) {
      platon::println("v_caller:", partner_vec[i]);
      if (strcmp(caller_h_str.c_str(), partner_vec[i].c_str()) == 0) {
        return true;
      }
    }
    return false;
  }

  /// blance is engouth for caller to pay the method's price.
  bool is_enough_price(const char *method) {
    // the price of method.
    platon::u256 fee;
    std::string key_str = KEY_METHOD_PRICE + std::string(method);
    platon::println("is_enough_price : key_str", key_str);
    platon::getState(key_str, fee);
    platon::println("is_enough_price:call get_fee. - ",
                    fee.convert_to<std::string>());
    // the pricee of value to caller.
    platon::u256 _value = platon::callValue();
    platon::println("is_enough_price:call get_value. - ",
                    _value.convert_to<std::string>());
    if (_value >= fee) {
      platon::println("is_enough_price: return true.");
      return true;
    }
    platon::println("is_enough_price: return false.");
    return false;
  }

  /// transfer of value, from user's account to contract's account.
  bool save_allot_amount(const char *task_id) {
    // platon::balance().convert_to<std::string>().c_str();
    platon::u256 value_u = platon::callValue();
    std::string key_str = PREFIX_ALLOT_MAP + std::string(task_id);

    std::string value_str = value_u.convert_to<std::string>();
    platon::println("save_allot_amount: ", key_str, " - ", value_str);
    platon::setState(key_str, value_u);
    return true;
  }

  platon::u256 get_saved_amount(const char *task_id) {
    std::string key_str = PREFIX_ALLOT_MAP + std::string(task_id);
    platon::u256 value_u;
    platon::getState(key_str, value_u);
    platon::println("get_saved_amout: ", value_u.convert_to<std::string>());
    return value_u;
  }

  void init_set_urls() {
    // URLS_VALUE -> "id01$tcpSession:tcp -p 9527,id02$tcpSession:tcp -p
    // 9527,id03$tcpSession:tcp -p 9527"
    char *values = URLS_VALUE;
    char *pattern = ",";
    // ["id01$tcpSession:tcp -p 9527", "id02$tcpSession:tcp -p 9527",
    // "id03$tcpSession:tcp -p 9527"] KEY_URLS + "id01" -> tcpSession:tcp -p
    // 9527
    platon::println("---- begin split ------");
    std::vector<std::string> arr = split(values, pattern);
    for (unsigned int i = 0; i < arr.size(); ++i) {
      char *trim_res = new char[100];
      char *str_in = new char[100];
      strcpy(str_in, arr[i].c_str());

      str_trim(str_in, trim_res);

      std::vector<std::string> id_valule_arr = split(str_in, "$");
      if (id_valule_arr.size() != 2) {
        platon::println("Invalid value str of urls.");
        platon::platonThrow("Invalid value str of urls.");
      }
      // do set state
      std::string _key = KEY_URLS + id_valule_arr[0];
      std::string _value = id_valule_arr[1];
      platon::println("init urls, key : ", _key, " , values: ", _value);
      platon::setState(_key, _value);
      delete[] str_in;
      delete[] trim_res;
    }
  }

  void init_set_price() {
    // METHOD_PRICE_VALUE ->
    // "func01$10000000000000000,func02$200000000000000,func03$4000000000000000000000000000"
    char *values = METHOD_PRICE_VALUE;
    char *pattern = ",";
    // ["func01$10000000000000000", "func01$10000000000000000",
    // "func01$10000000000000000"] PREFIX_METHOD_MAP + "func01" ->
    // 10000000000000000
    platon::println("---- Begin split price ------");

    std::vector<std::string> arr = split(values, pattern);
    platon::println("---- End split price ------", arr.size());
    for (unsigned int i = 0; i < arr.size(); ++i) {
      char *trim_res = new char[100];
      char *str_in = new char[100];
      strcpy(str_in, arr[i].c_str());
      str_trim(str_in, trim_res);

      std::vector<std::string> id_valule_arr = split(str_in, "$");
      if (id_valule_arr.size() != 2) {
        platon::println("Invalid value str of price.");
        platon::platonThrow("Invalid value str of price.");
      }
      // do set state
      std::string key_str = KEY_METHOD_PRICE + id_valule_arr[0];
      std::string value_str = id_valule_arr[1];
      platon::println("init price, key : ", key_str, " , values: ", value_str);
      platon::u256 value_u(value_str);
      platon::setState(key_str, value_u);
      delete[] str_in;
      delete[] trim_res;
    }
  }

private:
  uint64_t stouint64(const std::string &num) const {
    uint64_t res = 0;
    for (size_t i = 0; i < num.length(); i++) {
      res = res * 10 + (num[i] - '0');
    }
    platon::println("stouint64 ", num, "->", res);
    return res;
  }

  std::string toString(uint64_t num) const {
    std::string res;
    while (num != 0) {
      char c = num % 10 + '0';
      num /= 10;
      res.insert(0, 1, c);
    }
    platon::println("toString ", num, "->", res);
    return res;
  }

  std::vector<std::string> split(const std::string &str,
                                 const std::string &pattern) const {
    // const char* convert to char*
    char *strc = new char[std::strlen(str.c_str()) + 1];
    strcpy(strc, str.c_str());
    std::vector<std::string> result_vec;
    char *tmp_str = strtok(strc, pattern.c_str());
    while (tmp_str != NULL) {
      result_vec.push_back(std::string(tmp_str));
      tmp_str = strtok(NULL, pattern.c_str());
    }
    delete[] strc;
    return result_vec;
  }

  void str_trim(char *str_in, char *str_out) {
    int i, j;
    i = 0;
    j = strlen(str_in) - 1;
    while (str_in[i] == ' ') {
      i++;
    }
    while (str_in[j] == ' ') {
      --j;
    }
    strncpy(str_out, str_in + i, j - i + 1);
    str_out[j - i + 1] = '\0'; // end flag
  }
};
} // namespace mpc

PLATON_ABI(mpc::MPC, TestPerfAdd);
PLATON_ABI(mpc::MPC, TestPerfSub);
PLATON_ABI(mpc::MPC, TestPerfMul);
PLATON_ABI(mpc::MPC, TestPerfDiv);
PLATON_ABI(mpc::MPC, TestPerfMod);
PLATON_ABI(mpc::MPC, TestPerfAnd);
PLATON_ABI(mpc::MPC, TestPerfOrr);
PLATON_ABI(mpc::MPC, TestPerfEor);
PLATON_ABI(mpc::MPC, TestPerfAll);
PLATON_ABI(mpc::MPC, start_calc);
PLATON_ABI(mpc::MPC, get_owner);
PLATON_ABI(mpc::MPC, set_result);
PLATON_ABI(mpc::MPC, get_ir_data);
PLATON_ABI(mpc::MPC, get_participants);
PLATON_ABI(mpc::MPC, get_urls);
PLATON_ABI(mpc::MPC, get_result);
PLATON_ABI(mpc::MPC, get_status);
PLATON_ABI(mpc::MPC, get_fee);
PLATON_ABI(mpc::MPC, get_invitor);
PLATON_ABI(mpc::MPC, get_url_by_id);

#endif